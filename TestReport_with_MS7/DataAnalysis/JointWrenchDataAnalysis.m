fprintf('Reading log files about joint torque sensor and computed joint Cartesian wrench ...\n')

%% Read raw data from data log as needed
rootDir = ['C:\Users\', getenv('username'), '\Documents\DATALOG-MS7\GravityCompensator\'];
logFilesDir = [rootDir, 'logFile\IDM_ResetSensorEachTest\'];

% 15 configurations in total
for i = 1:15
    % joint wrench at each configuration
    logFilePose = [logFilesDir, 'logFile_Pose', num2str(i), '.log'];
    Output_PoseDir{i} = [logFilesDir, 'Output_Pose', num2str(i), '\'];
    mkdir(Output_PoseDir{i});
    arg = [ [rootDir,'VVLoggerConfig_JointWrench.xml '], logFilePose, ' both ', Output_PoseDir{i}, ' TM-04-18-20'];
    system( [rootDir, 'splitLog.exe ', arg] );
    
    % joint wrench at 'zero-troque' pose after each configuration. Ideally
    % torque along joint axis Tz should be zero.
    logFileZero = [logFilesDir, 'logFile_Pose0', num2str(i), '.log'];
    Output_ZeroDir{i} = [logFilesDir, 'Output_Pose0', num2str(i), '\'];
    mkdir(Output_ZeroDir{i});
    arg = [ [rootDir,'VVLoggerConfig_JointWrench.xml '], logFilePose, ' both ', Output_ZeroDir{i}, ' TM-04-18-20'];
    system( [rootDir, 'splitLog.exe ', arg] );
end



% SealEffectOnSensor
logFilesDir = [rootDir, 'logFile\SealEffectOnSensor\'];

% 15 configurations in total
for i = 1:7
    % joint wrench at each configuration
    logFileSealPositive = [logFilesDir, 'logFile_Pose', num2str(i), 'p.log'];
    logFileSealNegative = [logFilesDir, 'logFile_Pose', num2str(i), 'n.log'];
    Output_PositiveDir{i} = [logFilesDir, 'Output_Pose', num2str(i), 'p\'];
    Output_NegativeDir{i} = [logFilesDir, 'Output_Pose', num2str(i), 'n\'];
    mkdir(Output_PositiveDir{i});
    mkdir(Output_NegativeDir{i});
    
    arg = [ [rootDir,'VVLoggerConfig_JointWrench.xml '], logFileSealPositive, ' both ', Output_PositiveDir{i}, ' TM-04-18-20'];
    system( [rootDir, 'splitLog.exe ', arg] );
    arg = [ [rootDir,'VVLoggerConfig_JointWrench.xml '], logFileSealNegative, ' both ', Output_NegativeDir{i}, ' TM-04-18-20'];
    system( [rootDir, 'splitLog.exe ', arg] );
end


%% Extract needed values from generated txt files and save as RobotConfig

for iRobotConfig = 1:15
    
    RobotConfig(iRobotConfig).BaseJointCartesianWrench = [  mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchFx.txt']) ), ...
        mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchFy.txt']) ), ...
        mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchFz.txt']) ), ...
        mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchTx.txt']) ), ...
        mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchTy.txt']) ), ...
        mean( importdata([Output_PoseDir{iRobotConfig}, 'BaseJointCartesianWrenchTz.txt']) )];
        
    for jActuator = 1:7
        RobotConfig(iRobotConfig).Actuator(jActuator).Position = mean( importdata([Output_PoseDir{iRobotConfig}, 'ExternalPosition_', num2str(jActuator-1),'.txt']) );
        RobotConfig(iRobotConfig).Actuator(jActuator).Command = mean( importdata([Output_PoseDir{iRobotConfig}, 'DesiredJointsPos_', num2str(jActuator-1),'.txt']) );
        
        RobotConfig(iRobotConfig).Actuator(jActuator).CartesianWrench = [   mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchFx_', num2str(jActuator-1),'.txt']) ), ...
            mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchFy_', num2str(jActuator-1),'.txt']) ), ...
            mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchFz_', num2str(jActuator-1),'.txt']) ), ...
            mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchTx_', num2str(jActuator-1),'.txt']) ), ...
            mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchTy_', num2str(jActuator-1),'.txt']) ), ...
            mean( importdata([Output_PoseDir{iRobotConfig}, 'JointCartesianWrenchTz_', num2str(jActuator-1),'.txt']) )];
        
        RobotConfig(iRobotConfig).Actuator(jActuator).RawTorque = mean( importdata([Output_PoseDir{iRobotConfig}, 'RawTorque_', num2str(jActuator-1),'.txt']) );
        RobotConfig(iRobotConfig).Actuator(jActuator).RawTorqueVector = importdata([Output_PoseDir{iRobotConfig}, 'RawTorque_', num2str(jActuator-1),'.txt']); % very noisy
        
        
        RobotConfig(iRobotConfig).Actuator(jActuator).RawTorque0 = mean( importdata([Output_ZeroDir{iRobotConfig}, 'RawTorque_', num2str(jActuator-1),'.txt']) );
    end
   
end

% SealEffectOnSensor
for jActuator = 1:7
   ActuatorSealTorque(1, jActuator) = mean( importdata([Output_PositiveDir{jActuator}, 'RawTorque_', num2str(jActuator-1),'.txt']) );
   ActuatorSealTorque(2, jActuator) = mean( importdata([Output_NegativeDir{jActuator}, 'RawTorque_', num2str(jActuator-1),'.txt']) );
end


%% From Offline PC: Reference data from RobotBase C++ Class; Based on Nominal Joint Position Command (Not used)
JointWrench_PC{1} = [     0.0000 108.1749   0.0000 -27.3379   0.0000 -10.4812 
                         88.3820 -41.2106  -0.2399  -6.7632 -14.5661  10.5531 
                         40.4974 -60.8975 -34.1780  -6.9641  -2.3546  -4.0563 
                         41.7579   1.1580  47.7428  -0.7763   2.0507   0.6292 
                        -31.2503 -33.9514   0.7894   0.9069  -0.6424   8.2727 
                          9.0279 -19.1326  22.9621  -3.1109   0.6947   1.8019 
                        -10.4402 -15.6397 -14.6255  -2.2845   0.0885   1.5361 
                          2.2690  12.2418  10.8639   1.1882  -0.1837  -0.0412 ];

                    
JointWrench_PC{2} = [     0.0000 108.1749   0.0000 -28.5490   0.0000 -14.9069 
                         62.6938 -74.6939  -0.2473 -13.1928 -11.1229  14.9828 
                         22.0263 -46.8908 -61.9095 -13.1918  -1.3497  -3.6712 
                         49.0073  16.5282  36.7361   0.3161  -1.8943   0.4306 
                        -33.1053 -29.8452  11.9667   1.4009   0.6180   5.4167 
                         23.1426  -5.6553  20.1807  -0.3620   0.7098   0.6140 
                        -21.3897  -9.5346  -4.3673  -0.6583   0.1666   2.8607 
                          4.2643 -14.5173   6.6406  -1.0516  -0.3448  -0.0785  ];

JointWrench_PC{3} = [     0.0000 108.1749   0.0000 -32.3583   0.0000  -4.2812 
                        -89.7599  38.1161  -0.2705   8.2363  19.4268   4.3700 
                        -54.3694 -50.6464  31.5531   8.0576  -3.2026   8.7435 
                        -16.1713  46.5805  39.9146   4.5683  -3.1377   5.5126 
                         29.5937 -10.2302  33.9036   6.0910  -0.7544  -5.5443 
                         29.9424   5.6901   6.7746   0.1017  -0.1094  -0.3577 
                        -17.8393 -15.1948   4.2870   0.4937   0.1747   2.6736 
                          5.6544  11.3774  10.5649   1.1129  -0.4572  -0.1032];	

                    
JointWrench_PC{4} = [     0.0000 108.1749   0.0000 -37.6098   0.0000 -10.4370 
                         16.9318  96.0363  -0.3026  25.9373  -4.5397  10.5431 
                         14.0444   1.1005  79.4873  15.0790  -8.9672  -2.5401 
                        -23.9871  58.7211  -0.9425   2.9048   1.3203   8.3299 
                         12.2384 -12.3558  42.7488  10.5406   2.6209  -2.2601 
                        -10.9198  28.0744   8.2101   2.3970   1.8378  -3.0964 
                         -5.5665   8.7877  21.4311   3.1257  -0.0345   0.8260 
                         -2.7486 -15.1203  -6.0710  -1.3330   0.2223   0.0499 ];


JointWrench_PC{5} = [     0.0000 108.1749   0.0000 -21.4281   0.0000   1.1300 
                         97.1491   8.4713  -0.2037   0.8828 -10.1502  -1.0777 
                         20.0873 -77.8662   7.0744   4.6643   1.3315   1.4111 
                          9.0012  14.3018  61.1463   2.6377   7.8109  -2.2152 
                        -33.1079 -30.4275  10.3893   3.5681  -0.7580   9.1507 
                          2.6441 -23.3539  20.5529  -3.8591   1.3066   1.9811 
                        -10.3402 -11.9405 -17.8328  -2.6350  -0.0407   1.5551 
                         -4.8086  13.4552   8.2988   1.2393   0.3883   0.0884 ];


JointWrench_PC{6} = [     0.0000 108.1749   0.0000 -40.5986   0.0000  -9.6244 
                         62.6829 -74.7028  -0.3209 -22.4423 -18.8731   9.7406 
                         47.0541 -21.7637 -61.8784 -15.3858  -0.8103 -11.4149 
                         52.3852  31.5235  16.9261   3.7656  -5.6257  -1.1768 
                        -15.5076 -36.9593  22.8785   2.9688   0.1171   2.2015 
                         18.4887  -3.0604  24.9724  -0.5482   0.4056   0.4556 
                        -16.4454 -17.0699  -2.3813  -0.5431   0.2267   2.1253 
                          8.6703  -7.5587  11.8628  -0.3936  -0.7010  -0.1590];


JointWrench_PC{7} = [     0.0000 108.1749   0.0000 -29.8129   0.0000 -15.9609 
                         84.4611 -48.7444  -0.2551  -9.2191 -16.0581  16.0410 
                         35.1309 -60.3741 -40.4657 -12.7590  -3.3916  -6.0167 
                         41.6923  -6.8167  47.3257  -2.6848  -3.1633   1.9096 
                        -14.3410 -43.5785  -5.0154  -0.3711  -0.2289   3.0498 
                          6.8591  -7.5859  29.4996  -1.2201   1.8603   0.7621 
                        -16.6128 -16.0529  -5.8157  -0.9633   0.0917   2.4986 
                          1.2376  12.1260  11.1564   1.1842  -0.1003  -0.0223 ];


JointWrench_PC{8} = [     0.0000 108.1749   0.0000 -40.9162   0.0000  -4.0731 
                        -94.1908  25.2536  -0.3227   7.6673  28.6510   4.1904 
                        -30.8301 -71.6187  20.9035   9.0440   1.1973  17.4408 
                        -28.0455  -7.9523  56.3440  -4.1009  15.1080   0.0911 
                        -31.8844  32.8631  -5.7709  -0.7267   1.2158  10.9387 
                         21.8899   0.9173 -22.2443   0.1749  -5.0514  -0.0362 
                         20.6165  11.9167   0.6748   0.1245  -0.0443  -3.0212 
                          2.1519 -14.1196  -8.3091  -1.2931  -0.1736  -0.0398 ];


JointWrench_PC{9} = [     0.0000 108.1749   0.0000 -33.5498   0.0000  -3.2292 
                        -94.1904  25.2556  -0.2778   5.7651  21.5374   3.3219 
                        -40.4028 -66.6909  20.8956   7.3944  -1.2438  10.3276 
                         -4.9282  35.2765  52.4949   7.6127  -3.3283   2.9513 
                         26.1794 -28.0285  25.6698   5.0652   1.0082  -4.0649 
                        -16.7506 -18.4065  18.8530  -1.2688  -0.8911  -1.9973 
                         16.9131  -9.2016 -14.0279  -2.0740  -0.0792  -2.4486 
                         -0.8820  15.2303   6.3477   1.3470   0.0711   0.0166 ];


JointWrench_PC{10} = [    0.0000 108.1749   0.0000 -45.9860   0.0000  -1.1555 
                        -33.3317  91.6440  -0.3537  32.6449  11.8782   1.2897 
                        -21.8094 -16.9580  75.8516  18.6056  11.5064   7.9221 
                         -6.7971 -61.6517  13.3154  -9.1111  -1.2889 -10.6185 
                         10.8357  -0.9461 -44.8508  -9.8105  -3.3821  -2.2988 
                          1.4869  31.1803   0.6304   1.4230  -0.1284   2.9939 
                         -0.1301   1.2902  23.7870   3.3381   0.1317   0.0111 
                          7.5996 -14.6462  -0.8768  -1.1996  -0.6141  -0.1396 ];


JointWrench_PC{11} = [    0.0000 108.1749   0.0000 -59.1599   0.0000   0.5697 
                         -0.0273 -97.5170  -0.4341 -47.9183   0.0152  -0.3916 
                          0.0293   0.5053 -80.7244 -36.3357   0.2237  -0.0118 
                         -0.0970 -63.4356  -0.5870 -24.2782   0.0384  -0.1315 
                         -0.1390   0.4746 -46.1482 -14.8091   0.0491   0.0451 
                         -0.1629 -31.2198  -0.3447  -6.2185   0.0327  -0.0188 
                         -0.1789   0.2733 -23.8201  -3.3184   0.0098   0.0250 
                          0.0633  16.5226  -0.1856   1.3318  -0.0051  -0.0007];


JointWrench_PC{12} = [    0.0000 108.1749   0.0000 -59.2005   0.0000  11.7371 
                        -97.5170   0.0566  -0.4342   0.0793  47.9961 -11.5586 
                        -80.7255   0.2467  -0.1337  -0.0366   7.7422  36.4012 
                        -63.4384  -0.0462  -0.0188  -0.0164  24.3227  -4.2699 
                        -46.1504  -0.2033   0.0262  -0.0006   2.0400  14.8316 
                        -31.2219   0.0640   0.0776   0.0119   6.2223  -0.3332 
                        -23.8215  -0.1648   0.1017   0.0114   0.3994   3.3230 
                         16.5231  -0.0089   0.1441   0.0019  -1.3352  -0.3025 ];


JointWrench_PC{13} = [    0.0000 108.1749   0.0000 -55.7682   0.0000   3.8124 
                         -0.0357 -97.5171  -0.4133 -44.5374   0.0318  -3.6455 
                          0.0594   0.4824 -80.7245 -32.9679   3.4917  -0.0034 
                         -0.0474 -63.4360  -0.5536 -20.9185   0.0454  -3.4103 
                         -0.0978   0.4453 -46.1486 -11.4647   3.3466   0.0566 
                         -0.0985 -31.2205  -0.3036  -2.8791   0.0414  -3.3240 
                         -0.2457  -0.1207 -23.8207  -3.3251   0.0109   0.0342 
                          0.1089  16.5232   0.0879   1.3368  -0.0088  -0.0015 ];


JointWrench_PC{14} = [    0.0000 108.1749   0.0000 -44.0802   0.0000  15.1053 
                         -0.0651 -97.5174  -0.3419 -32.8871   0.0745 -14.9773 
                          0.1643   0.4034 -80.7248 -21.3630  14.8719   0.0308 
                          0.1255 -63.4368  -0.4386  -9.3424   0.0840 -14.8276 
                         -0.3443   0.0455 -46.1495 -14.8287   0.0582   0.1107 
                         -0.3012 -31.2206  -0.0543  -6.2218   0.0601  -0.0202 
                         -0.2838   0.0514 -23.8206  -3.3222   0.0115   0.0396 
                          0.1356  16.5232  -0.0315   1.3347  -0.0110  -0.0020 ];


JointWrench_PC{15} = [    0.0000 108.1749   0.0000 -22.3083   0.0000  36.4210 
                         -0.1206 -97.5177  -0.2088 -11.1863   0.0917 -36.3654 
                         -0.2562   0.3623 -80.7248 -36.3501   0.2518   0.1165 
                         -0.3208 -63.4358  -0.4740 -24.2861   0.1239  -0.1472 
                         -0.3013   0.3915 -46.1482 -14.8128   0.0563   0.0972 
                         -0.2726 -31.2196  -0.2884  -6.2191   0.0545  -0.0199 
                         -0.2625   0.2301 -23.8198  -3.3191   0.0112   0.0367 
                          0.1211  16.5226  -0.1554   1.3323  -0.0098  -0.0017 ];

                      
%% From Offline PC: Reference data from RobotBase C++ Class; Based on Nominal Joint Position Feedback (Not used)
JointWrench_PC_FB{1} = [  0.0000 108.1749   0.0000 -27.3377   0.0000 -10.4811 
                         88.3820 -41.2106  -0.2399  -6.7631 -14.5659  10.5531 
                         40.4963 -60.8982 -34.1780  -6.9641  -2.3545  -4.0562 
                         41.7572   1.1581  47.7433  -0.7762   2.0508   0.6292 
                        -31.2501 -33.9515   0.7895   0.9069  -0.6424   8.2726 
                          9.0281 -19.1325  22.9622  -3.1108   0.6947   1.8019 
                        -10.4402 -15.6398 -14.6254  -2.2845   0.0885   1.5361 
                          2.2691  12.2418  10.8640   1.1882  -0.1837  -0.0412];
                    
JointWrench_PC_FB{2} = [  0.0000 108.1749   0.0000 -28.5489   0.0000 -14.9070 
                         62.6938 -74.6939  -0.2473 -13.1927 -11.1229  14.9829 
                         22.0254 -46.8912 -61.9095 -13.1920  -1.3496  -3.6711 
                         49.0070  16.5285  36.7364   0.3162  -1.8944   0.4306 
                        -33.1050 -29.8456  11.9668   1.4009   0.6179   5.4165 
                         23.1422  -5.6558  20.1809  -0.3620   0.7099   0.6141 
                        -21.3899  -9.5340  -4.3677  -0.6584   0.1666   2.8607 
                          4.2649 -14.5174   6.6402  -1.0516  -0.3448  -0.0785 ];

JointWrench_PC_FB{3} = [  0.0000 108.1749   0.0000 -32.3581   0.0000  -4.2817 
                        -89.7579  38.1208  -0.2705   8.2372  19.4262   4.3705 
                        -54.3682 -50.6453  31.5569   8.0582  -3.2027   8.7432 
                        -16.1719  46.5811  39.9137   4.5683  -3.1375   5.5126 
                         29.5932 -10.2303  33.9040   6.0911  -0.7543  -5.5442 
                         29.9424   5.6900   6.7747   0.1017  -0.1094  -0.3577 
                        -17.8396 -15.1945   4.2869   0.4937   0.1747   2.6737 
                          5.6542  11.3777  10.5647   1.1129  -0.4572  -0.1032 ];	
                    
JointWrench_PC_FB{4} = [  0.0000 108.1749   0.0000 -37.6098   0.0000 -10.4373 
                         16.9318  96.0363  -0.3026  25.9373  -4.5397  10.5435 
                         14.0444   1.1007  79.4873  15.0793  -8.9673  -2.5401 
                        -23.9871  58.7211  -0.9427   2.9049   1.3204   8.3300 
                         12.2381 -12.3561  42.7488  10.5406   2.6209  -2.2600 
                        -10.9200  28.0742   8.2103   2.3970   1.8379  -3.0964 
                         -5.5667   8.7878  21.4310   3.1257  -0.0345   0.8260 
                         -2.7482 -15.1203  -6.0711  -1.3330   0.2223   0.0499 ];

JointWrench_PC_FB{5} = [  0.0000 108.1749   0.0000 -21.4280   0.0000   1.1301 
                         97.1491   8.4713  -0.2037   0.8828 -10.1502  -1.0778 
                         20.0873 -77.8662   7.0744   4.6644   1.3315   1.4112 
                          9.0012  14.3018  61.1463   2.6377   7.8110  -2.2152 
                        -33.1084 -30.4269  10.3893   3.5681  -0.7580   9.1507 
                          2.6441 -23.3543  20.5525  -3.8591   1.3066   1.9812 
                        -10.3404 -11.9399 -17.8330  -2.6350  -0.0407   1.5552 
                         -4.8089  13.4554   8.2984   1.2393   0.3884   0.0885 ];

JointWrench_PC_FB{6} = [  0.0000 108.1749   0.0000 -40.5986   0.0000  -9.6249 
                         62.6829 -74.7028  -0.3209 -22.4422 -18.8730   9.7410 
                         47.0538 -21.7646 -61.8784 -15.3860  -0.8104 -11.4148 
                         52.3853  31.5230  16.9268   3.7656  -5.6258  -1.1766 
                        -15.5074 -36.9596  22.8782   2.9686   0.1171   2.2014 
                         18.4884  -3.0603  24.9726  -0.5482   0.4057   0.4556 
                        -16.4458 -17.0695  -2.3813  -0.5431   0.2267   2.1254 
                          8.6706  -7.5588  11.8625  -0.3936  -0.7010  -0.1590];

JointWrench_PC_FB{7} = [  0.0000 108.1749   0.0000 -29.8126   0.0000 -15.9610 
                         84.4611 -48.7444  -0.2551  -9.2189 -16.0579  16.0411 
                         35.1309 -60.3741 -40.4657 -12.7591  -3.3918  -6.0165 
                         41.6922  -6.8174  47.3257  -2.6850  -3.1631   1.9098 
                        -14.3418 -43.5781  -5.0159  -0.3713  -0.2289   3.0500 
                          6.8598  -7.5860  29.4994  -1.2202   1.8601   0.7621 
                        -16.6118 -16.0539  -5.8158  -0.9633   0.0917   2.4985 
                          1.2375  12.1254  11.1570   1.1841  -0.1003  -0.0223 ];

JointWrench_PC_FB{8} = [  0.0000 108.1749   0.0000 -40.9160   0.0000  -4.0733 
                        -94.1908  25.2536  -0.3227   7.6673  28.6509   4.1905 
                        -30.8289 -71.6192  20.9035   9.0441   1.1973  17.4407 
                        -28.0449  -7.9515  56.3444  -4.1009  15.1082   0.0909 
                        -31.8854  32.8622  -5.7704  -0.7266   1.2158  10.9390 
                         21.8906   0.9162 -22.2437   0.1747  -5.0514  -0.0362 
                         20.6166  11.9165   0.6740   0.1244  -0.0443  -3.0212 
                          2.1511 -14.1198  -8.3090  -1.2932  -0.1736  -0.0398];

JointWrench_PC_FB{9} = [ 0.0000 108.1749   0.0000 -33.5505   0.0000  -3.2291 
                        -94.1904  25.2556  -0.2778   5.7653  21.5380   3.3218 
                        -40.4040 -66.6902  20.8956   7.3944  -1.2437  10.3283 
                         -4.9287  35.2773  52.4943   7.6130  -3.3280   2.9513 
                         26.1784 -28.0290  25.6704   5.0654   1.0083  -4.0646 
                        -16.7495 -18.4072  18.8533  -1.2689  -0.8911  -1.9974 
                         16.9129  -9.2012 -14.0284  -2.0741  -0.0792  -2.4486 
                         -0.8816  15.2305   6.3475   1.3470   0.0711   0.0166];

JointWrench_PC_FB{10} = [ 0.0000 108.1749   0.0000 -45.9861   0.0000  -1.1555 
                        -33.3317  91.6440  -0.3537  32.6449  11.8782   1.2897 
                        -21.8094 -16.9580  75.8516  18.6056  11.5064   7.9221 
                         -6.7966 -61.6518  13.3154  -9.1112  -1.2889 -10.6186 
                         10.8356  -0.9459 -44.8508  -9.8105  -3.3822  -2.2988 
                          1.4874  31.1803   0.6302   1.4231  -0.1284   2.9940 
                         -0.1304   1.2904  23.7870   3.3381   0.1317   0.0111 
                          7.5995 -14.6463  -0.8770  -1.1996  -0.6141  -0.1396];

JointWrench_PC_FB{11} = [ 0.0000 108.1749   0.0000 -59.1599   0.0000   0.5697 
                         -0.0273 -97.5170  -0.4341 -47.9183   0.0152  -0.3916 
                          0.0293   0.5053 -80.7244 -36.3357   0.2237  -0.0118 
                         -0.0970 -63.4356  -0.5870 -24.2782   0.0384  -0.1315 
                         -0.1390   0.4746 -46.1482 -14.8091   0.0491   0.0451 
                         -0.1629 -31.2198  -0.3447  -6.2185   0.0327  -0.0188 
                         -0.1789   0.2733 -23.8201  -3.3184   0.0098   0.0250 
                          0.0633  16.5226  -0.1856   1.3318  -0.0051  -0.0007 ];

JointWrench_PC_FB{12} = [ 0.0000 108.1749   0.0000 -59.2005   0.0000  11.7371 
                        -97.5170   0.0566  -0.4342   0.0793  47.9961 -11.5586 
                        -80.7255   0.2467  -0.1337  -0.0366   7.7422  36.4012 
                        -63.4384  -0.0462  -0.0188  -0.0164  24.3227  -4.2699 
                        -46.1504  -0.2033   0.0262  -0.0006   2.0400  14.8316 
                        -31.2219   0.0640   0.0776   0.0119   6.2223  -0.3332 
                        -23.8215  -0.1648   0.1017   0.0114   0.3994   3.3230 
                         16.5231  -0.0089   0.1441   0.0019  -1.3352  -0.3025 ];

JointWrench_PC_FB{13} = [ 0.0000 108.1749   0.0000 -55.7682   0.0000   3.8124 
                         -0.0357 -97.5171  -0.4133 -44.5374   0.0318  -3.6455 
                          0.0594   0.4824 -80.7245 -32.9679   3.4917  -0.0034 
                         -0.0474 -63.4360  -0.5536 -20.9185   0.0454  -3.4103 
                         -0.0978   0.4453 -46.1486 -11.4647   3.3466   0.0566 
                         -0.0985 -31.2205  -0.3036  -2.8791   0.0414  -3.3240 
                         -0.2457  -0.1207 -23.8207  -3.3251   0.0109   0.0342 
                          0.1089  16.5232   0.0879   1.3368  -0.0088  -0.0015];

JointWrench_PC_FB{14} = [ 0.0000 108.1749   0.0000 -44.0802   0.0000  15.1053 
                         -0.0651 -97.5174  -0.3419 -32.8871   0.0745 -14.9773 
                          0.1643   0.4034 -80.7248 -21.3630  14.8719   0.0308 
                          0.1255 -63.4368  -0.4386  -9.3424   0.0840 -14.8276 
                         -0.3443   0.0455 -46.1495 -14.8287   0.0582   0.1107 
                         -0.3012 -31.2206  -0.0543  -6.2218   0.0601  -0.0202 
                         -0.2838   0.0514 -23.8206  -3.3222   0.0115   0.0396 
                          0.1356  16.5232  -0.0315   1.3347  -0.0110  -0.0020];

JointWrench_PC_FB{15} = [ 0.0000 108.1749   0.0000 -22.3083   0.0000  36.4210 
                         -0.1206 -97.5177  -0.2088 -11.1863   0.0917 -36.3654 
                         -0.2562   0.3623 -80.7248 -36.3501   0.2518   0.1165 
                         -0.3208 -63.4358  -0.4740 -24.2861   0.1239  -0.1472 
                         -0.3013   0.3915 -46.1482 -14.8128   0.0563   0.0972 
                         -0.2726 -31.2196  -0.2884  -6.2191   0.0545  -0.0199 
                         -0.2625   0.2301 -23.8198  -3.3191   0.0112   0.0367 
                          0.1211  16.5226  -0.1554   1.3323  -0.0098  -0.0017];


%% From Offline PC: Reference data from RobotBase C++ Class; Based on Nominal Joint Position Command; Calibration matrix not applied
JointWrench_PC{1} = [  0.0000 108.1749   0.0000 -26.9294   0.0000 -10.4385 
                     88.3813 -41.2129   0.0000  -6.6482 -14.2571  10.4379 
                     40.0077 -61.2548 -34.1163  -6.8397  -2.3645  -3.7754 
                     41.3077   0.9694  48.1370  -0.8133   2.2332   0.6529 
                    -31.7388 -33.4970   0.7052   0.8670  -0.6445   8.4087 
                      9.3230 -19.3483  22.6615  -3.1205   0.6351   1.8261 
                    -10.1604 -15.6950 -14.7627  -2.3025   0.0795   1.5002 
                      2.1196  12.2486  10.8864   1.1891  -0.1716  -0.0384 ];

                    
JointWrench_PC{2} = [  0.0000 108.1749   0.0000 -28.1356   0.0000 -14.8875 
                     62.6833 -74.7031   0.0000 -12.9746 -10.8870  14.8870 
                     21.5842 -47.1875 -61.8397 -13.0452  -1.4418  -3.4530 
                     48.8627  16.1795  37.0822   0.1969  -1.7831   0.5185 
                    -33.4761 -29.5078  11.7704   1.3541   0.6664   5.5219 
                     23.3919  -5.3970  19.9627  -0.3368   0.6854   0.5800 
                    -21.3574  -9.7163  -4.1179  -0.6232   0.1599   2.8552 
                      4.0351 -14.5373   6.7394  -1.0514  -0.3263  -0.0743 ];


JointWrench_PC{3} = [  0.0000 108.1749   0.0000 -32.3267   0.0000  -4.2492 
                    -89.7658  38.1033   0.0000   8.2555  19.4486   4.2486 
                    -54.3901 -50.6309  31.5422   7.9955  -3.1052   8.8028 
                    -16.3872  46.6132  39.7883   4.5748  -3.0284   5.4321 
                     29.4566 -10.5962  33.9106   6.0459  -0.7245  -5.4782 
                     29.8256   5.8195   7.1686   0.1017  -0.0633  -0.3718 
                    -18.0636 -14.8827   4.4402   0.5170   0.1789   2.7028 
                      5.8455  11.5022  10.3230   1.1185  -0.4727  -0.1067 ];	

                    
JointWrench_PC{4} = [  0.0000 108.1749   0.0000 -37.5746   0.0000 -10.3631 
                     16.9338  96.0365   0.0000  25.9755  -4.5802  10.3626 
                     13.9951   0.7996  79.4996  15.1159  -8.8592  -2.5719 
                    -24.1999  58.6379  -0.6284   2.9538   1.3075   8.2603 
                     12.4947 -12.4110  42.6585  10.4943   2.6242  -2.3103 
                    -10.7742  28.0756   8.3963   2.3780   1.8363  -3.0890 
                     -5.6655   8.7477  21.4215   3.1230  -0.0277   0.8373 
                     -2.7496 -15.1215  -6.0676  -1.3331   0.2224   0.0499 ];


JointWrench_PC{5} = [  0.0000 108.1749   0.0000 -21.0004   0.0000   1.0877 
                     97.1469   8.4993   0.0000   0.8543  -9.7647  -1.0882 
                     19.5504 -78.0062   7.0357   4.6632   1.3271   1.7565 
                      8.5309  13.9225  61.3011   2.4953   7.9974  -2.1636 
                    -33.5485 -30.0302  10.1285   3.4746  -0.7541   9.2729 
                      3.0373 -23.5128  20.3161  -3.8614   1.2320   2.0032 
                    -10.0236 -12.0491 -17.9401  -2.6493  -0.0504   1.5141 
                     -4.9469  13.3684   8.3576   1.2333   0.3995   0.0910 ];


JointWrench_PC{6} = [  0.0000 108.1749   0.0000 -40.1542   0.0000  -9.7958 
                     62.6833 -74.7031   0.0000 -22.1814 -18.6124   9.7952 
                     46.8310 -22.3472 -61.8397 -15.1976  -0.9151 -11.1784 
                     52.2432  31.4114  17.5616   3.6196  -5.4116  -1.0884 
                    -16.1423 -36.7034  22.8515   2.9506   0.1957   2.3987 
                     18.7452  -2.6220  24.8307  -0.4845   0.3763   0.4055 
                    -16.3613 -17.1991  -2.0006  -0.4897   0.2198   2.1152 
                      8.4161  -7.7387  11.9297  -0.4069  -0.6805  -0.1543 ];


JointWrench_PC{7} = [  0.0000 108.1749   0.0000 -29.3426   0.0000 -15.8765 
                     84.4530 -48.7590   0.0000  -9.0721 -15.7133  15.8760 
                     34.6273 -60.7327 -40.3630 -12.5834  -3.3880  -5.6975 
                     41.2102  -6.9508  47.7267  -2.7018  -2.9276   1.9066 
                    -14.9883 -43.3553  -5.0566  -0.3930  -0.2412   3.2334 
                      7.1472  -7.9648  29.3308  -1.2577   1.8144   0.7992 
                    -16.4419 -16.1318  -6.0771  -0.9995   0.0853   2.4778 
                      1.0798  12.1105  11.1894   1.1835  -0.0876  -0.0194 ];


JointWrench_PC{8} = [  0.0000 108.1749   0.0000 -40.7575   0.0000  -4.1932 
                    -94.1951  25.2395   0.0000   7.6504  28.5518   4.1927 
                    -30.7803 -71.6430  20.8934   9.0381   1.1857  17.3807 
                    -28.0880  -8.1081  56.3006  -4.0882  15.0731   0.1311 
                    -31.6901  33.0280  -5.8985  -0.7479   1.2244  10.8741 
                     21.7839   1.0097 -22.3442   0.1878  -5.0407  -0.0447 
                     20.5809  11.9723   0.7704   0.1377  -0.0424  -3.0209 
                      2.1618 -14.1209  -8.3043  -1.2932  -0.1744  -0.0400 ];


JointWrench_PC{9} = [  0.0000 108.1749   0.0000 -33.5108   0.0000  -3.2177 
                    -94.1951  25.2395   0.0000   5.7749  21.5521   3.2171 
                    -40.4166 -66.6832  20.8934   7.3088  -1.1772  10.3810 
                     -5.1016  35.3885  52.4029   7.6205  -3.2051   2.9064 
                     25.8768 -28.2400  25.7448   5.0807   1.0385  -3.9677 
                    -16.4586 -18.4101  19.1050  -1.2807  -0.9321  -2.0016 
                     17.0267  -8.9598 -14.0468  -2.0721  -0.0839  -2.4582 
                     -0.8567  15.2865   6.2148   1.3491   0.0690   0.0161 ];


JointWrench_PC{10} = [  0.0000 108.1749   0.0000 -45.9037   0.0000  -1.1715 
                    -33.3531  91.6369   0.0000  32.6122  11.8699   1.1710 
                    -21.6796 -17.0969  75.8576  18.5977  11.5327   7.9143 
                     -6.8255 -61.6225  13.4356  -9.1616  -1.2975 -10.6054 
                     10.9234  -0.9329 -44.8298  -9.8036  -3.4075  -2.3179 
                      1.3213  31.1877   0.6311   1.4349  -0.1215   3.0004 
                     -0.0534   1.1159  23.7961   3.3356   0.1374   0.0010 
                      7.4982 -14.7042  -0.7740  -1.2024  -0.6059  -0.1377 ];


JointWrench_PC{11} = [  0.0000 108.1749   0.0000 -59.1388   0.0000   0.0005 
                      0.0000 -97.5180   0.0000 -47.9403   0.0000  -0.0011 
                      0.0000   0.0000 -80.7260 -36.3751   0.0006  -0.0000 
                      0.0000 -63.4384   0.0000 -24.3045   0.0000  -0.0004 
                      0.0000   0.0000 -46.1509 -14.8206   0.0002  -0.0000 
                      0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                      0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                     -0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];


JointWrench_PC{12} = [  0.0000 108.1749   0.0000 -59.1388   0.0000  11.4968 
                    -97.5180  -0.0000   0.0000  -0.0000  47.9403 -11.4973 
                    -80.7260  -0.0000  -0.0000  -0.0000   7.7253  36.3751 
                    -63.4384  -0.0000   0.0000  -0.0000  24.3045  -4.2715 
                    -46.1509  -0.0000  -0.0000  -0.0000   2.0463  14.8206 
                    -31.2221  -0.0000   0.0000  -0.0000   6.2177  -0.3282 
                    -23.8223  -0.0000  -0.0000  -0.0000   0.3979   3.3222 
                     16.5238   0.0000   0.0000   0.0000  -1.3353  -0.3026 ];


JointWrench_PC{13} = [  0.0000 108.1749   0.0000 -55.8165   0.0000   3.3226 
                      0.0000 -97.5180   0.0000 -44.6181   0.0000  -3.3231 
                      0.0000   0.0000 -80.7260 -33.0529   3.3226  -0.0000 
                      0.0000 -63.4384   0.0000 -20.9822   0.0000  -3.3225 
                      0.0000   0.0000 -46.1509 -11.4984   3.3223  -0.0000 
                      0.0000 -31.2221   0.0000  -2.8955   0.0000  -3.3227 
                     -0.0000   0.0000 -23.8223  -3.3222   0.0001   0.0000 
                      0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];


JointWrench_PC{14} = [  0.0000 108.1749   0.0000 -44.3179   0.0000  14.8209 
                      0.0000 -97.5180   0.0000 -33.1195   0.0000 -14.8214 
                      0.0000   0.0000 -80.7260 -21.5543  14.8209  -0.0000 
                      0.0000 -63.4384   0.0000  -9.4837   0.0000 -14.8208 
                     -0.0000   0.0000 -46.1509 -14.8206   0.0002   0.0000 
                     -0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                      0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                      0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];


JointWrench_PC{15} = [  0.0000 108.1749   0.0000 -22.7631   0.0000  36.3751 
                      0.0000 -97.5180   0.0000 -11.5646   0.0000 -36.3756 
                     -0.0000   0.0000 -80.7260 -36.3751   0.0006   0.0000 
                     -0.0000 -63.4384   0.0000 -24.3045   0.0000  -0.0004 
                      0.0000   0.0000 -46.1509 -14.8206   0.0002  -0.0000 
                     -0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                      0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                      0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];

                      
%% From Offline PC: Reference data from RobotBase C++ Class; Based on Nominal Joint Position Feedback; Calibration matrix not applied
JointWrench_PC_FB{1} = [  0.0000 108.1749   0.0000 -26.9292   0.0000 -10.4384 
                         88.3813 -41.2129   0.0000  -6.6481 -14.2569  10.4379 
                         40.0066 -61.2555 -34.1163  -6.8397  -2.3644  -3.7753 
                         41.3070   0.9696  48.1375  -0.8133   2.2332   0.6529 
                        -31.7387 -33.4971   0.7053   0.8671  -0.6445   8.4087 
                          9.3231 -19.3482  22.6616  -3.1205   0.6351   1.8261 
                        -10.1604 -15.6951 -14.7626  -2.3025   0.0795   1.5002 
                          2.1196  12.2485  10.8865   1.1891  -0.1716  -0.0384 ];
                    
JointWrench_PC_FB{2} = [  0.0000 108.1749   0.0000 -28.1355   0.0000 -14.8877 
                         62.6833 -74.7031   0.0000 -12.9745 -10.8869  14.8871 
                         21.5834 -47.1879 -61.8397 -13.0453  -1.4417  -3.4530 
                         48.8624  16.1797  37.0825   0.1970  -1.7832   0.5184 
                        -33.4757 -29.5082  11.7705   1.3542   0.6663   5.5217 
                         23.3916  -5.3975  19.9629  -0.3368   0.6855   0.5800 
                        -21.3577  -9.7156  -4.1183  -0.6233   0.1599   2.8552 
                          4.0357 -14.5373   6.7390  -1.0514  -0.3263  -0.0743 ];

JointWrench_PC_FB{3} = [  0.0000 108.1749   0.0000 -32.3265   0.0000  -4.2497 
                        -89.7638  38.1080   0.0000   8.2564  19.4480   4.2492 
                        -54.3889 -50.6298  31.5460   7.9961  -3.1052   8.8024 
                        -16.3878  46.6137  39.7874   4.5749  -3.0282   5.4321 
                         29.4561 -10.5963  33.9110   6.0459  -0.7245  -5.4780 
                         29.8256   5.8194   7.1687   0.1017  -0.0633  -0.3718 
                        -18.0639 -14.8823   4.4402   0.5170   0.1789   2.7029 
                          5.8453  11.5025  10.3228   1.1185  -0.4727  -0.1067 ];	
                    
JointWrench_PC_FB{4} = [  0.0000 108.1749   0.0000 -37.5747   0.0000 -10.3634 
                         16.9338  96.0365   0.0000  25.9755  -4.5802  10.3629 
                         13.9951   0.7998  79.4996  15.1161  -8.8593  -2.5719 
                        -24.1999  58.6379  -0.6286   2.9539   1.3076   8.2604 
                         12.4944 -12.4113  42.6585  10.4942   2.6242  -2.3102 
                        -10.7743  28.0754   8.3965   2.3779   1.8364  -3.0890 
                         -5.6657   8.7479  21.4214   3.1230  -0.0277   0.8373 
                         -2.7492 -15.1215  -6.0677  -1.3331   0.2223   0.0499 ];

JointWrench_PC_FB{5} = [  0.0000 108.1749   0.0000 -21.0004   0.0000   1.0877 
                         97.1469   8.4993   0.0000   0.8543  -9.7646  -1.0883 
                         19.5504 -78.0062   7.0357   4.6633   1.3272   1.7566 
                          8.5309  13.9225  61.3011   2.4954   7.9975  -2.1636 
                        -33.5490 -30.0296  10.1285   3.4746  -0.7542   9.2730 
                          3.0373 -23.5131  20.3157  -3.8613   1.2320   2.0032 
                        -10.0239 -12.0485 -17.9404  -2.6493  -0.0504   1.5141 
                         -4.9472  13.3685   8.3572   1.2333   0.3995   0.0910 ];

JointWrench_PC_FB{6} = [  0.0000 108.1749   0.0000 -40.1541   0.0000  -9.7962 
                         62.6833 -74.7031   0.0000 -22.1813 -18.6123   9.7956 
                         46.8306 -22.3481 -61.8397 -15.1977  -0.9152 -11.1783 
                         52.2433  31.4109  17.5622   3.6196  -5.4117  -1.0882 
                        -16.1421 -36.7037  22.8511   2.9505   0.1957   2.3986 
                         18.7449  -2.6219  24.8309  -0.4844   0.3764   0.4055 
                        -16.3618 -17.1986  -2.0005  -0.4897   0.2199   2.1153 
                          8.4164  -7.7388  11.9294  -0.4069  -0.6805  -0.1543 ];

JointWrench_PC_FB{7} = [  0.0000 108.1749   0.0000 -29.3423   0.0000 -15.8766 
                         84.4530 -48.7590   0.0000  -9.0719 -15.7131  15.8761 
                         34.6273 -60.7327 -40.3630 -12.5835  -3.3881  -5.6973 
                         41.2100  -6.9515  47.7267  -2.7021  -2.9274   1.9068 
                        -14.9891 -43.3550  -5.0572  -0.3933  -0.2412   3.2336 
                          7.1479  -7.9650  29.3306  -1.2578   1.8142   0.7992 
                        -16.4409 -16.1328  -6.0773  -0.9996   0.0853   2.4776 
                          1.0796  12.1099  11.1901   1.1835  -0.0876  -0.0194 ];

JointWrench_PC_FB{8} = [ 0.0000 108.1749   0.0000 -40.7574   0.0000  -4.1934 
                        -94.1951  25.2395   0.0000   7.6504  28.5517   4.1928 
                        -30.7790 -71.6436  20.8934   9.0382   1.1858  17.3806 
                        -28.0874  -8.1073  56.3010  -4.0882  15.0733   0.1310 
                        -31.6911  33.0271  -5.8980  -0.7478   1.2244  10.8744 
                         21.7845   1.0087 -22.3436   0.1876  -5.0408  -0.0447 
                         20.5810  11.9721   0.7696   0.1376  -0.0424  -3.0209 
                          2.1610 -14.1211  -8.3042  -1.2932  -0.1744  -0.0400];

JointWrench_PC_FB{9} = [  0.0000 108.1749   0.0000 -33.5115   0.0000  -3.2176 
                        -94.1951  25.2395   0.0000   5.7751  21.5528   3.2171 
                        -40.4178 -66.6825  20.8934   7.3088  -1.1772  10.3817 
                         -5.1021  35.3892  52.4024   7.6209  -3.2048   2.9063 
                         25.8758 -28.2405  25.7453   5.0809   1.0386  -3.9674 
                        -16.4575 -18.4107  19.1053  -1.2808  -0.9322  -2.0016 
                         17.0266  -8.9594 -14.0473  -2.0722  -0.0839  -2.4581 
                         -0.8564  15.2866   6.2145   1.3491   0.0690   0.0161 ];

JointWrench_PC_FB{10} = [ 0.0000 108.1749   0.0000 -45.9037   0.0000  -1.1715 
                        -33.3531  91.6369   0.0000  32.6123  11.8699   1.1710 
                        -21.6796 -17.0969  75.8576  18.5977  11.5328   7.9144 
                         -6.8250 -61.6225  13.4356  -9.1616  -1.2976 -10.6054 
                         10.9233  -0.9326 -44.8298  -9.8037  -3.4076  -2.3179 
                          1.3217  31.1877   0.6309   1.4350  -0.1215   3.0005 
                         -0.0536   1.1162  23.7961   3.3356   0.1374   0.0011 
                          7.4981 -14.7042  -0.7742  -1.2024  -0.6059  -0.1377];

JointWrench_PC_FB{11} = [ 0.0000 108.1749   0.0000 -59.1388   0.0000   0.0005 
                          0.0000 -97.5180   0.0000 -47.9403   0.0000  -0.0011 
                          0.0000   0.0000 -80.7260 -36.3751   0.0006  -0.0000 
                          0.0000 -63.4384   0.0000 -24.3045   0.0000  -0.0004 
                          0.0000   0.0000 -46.1509 -14.8206   0.0002  -0.0000 
                          0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                          0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                         -0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];

JointWrench_PC_FB{12} = [ 0.0000 108.1749   0.0000 -59.1388   0.0000  11.4968 
                        -97.5180  -0.0000   0.0000  -0.0000  47.9403 -11.4973 
                        -80.7260  -0.0000  -0.0000  -0.0000   7.7253  36.3751 
                        -63.4384  -0.0000   0.0000  -0.0000  24.3045  -4.2715 
                        -46.1509  -0.0000  -0.0000  -0.0000   2.0463  14.8206 
                        -31.2221  -0.0000   0.0000  -0.0000   6.2177  -0.3282 
                        -23.8223  -0.0000  -0.0000  -0.0000   0.3979   3.3222 
                         16.5238   0.0000   0.0000   0.0000  -1.3353  -0.3026];

JointWrench_PC_FB{13} = [ 0.0000 108.1749   0.0000 -55.8165   0.0000   3.3226 
                          0.0000 -97.5180   0.0000 -44.6181   0.0000  -3.3231 
                          0.0000   0.0000 -80.7260 -33.0529   3.3226  -0.0000 
                          0.0000 -63.4384   0.0000 -20.9822   0.0000  -3.3225 
                          0.0000   0.0000 -46.1509 -11.4984   3.3223  -0.0000 
                          0.0000 -31.2221   0.0000  -2.8955   0.0000  -3.3227 
                         -0.0000   0.0000 -23.8223  -3.3222   0.0001   0.0000 
                          0.0000  16.5238   0.0000   1.3353   0.0000   0.0005];

JointWrench_PC_FB{14} = [ 0.0000 108.1749   0.0000 -44.3179   0.0000  14.8209 
                          0.0000 -97.5180   0.0000 -33.1195   0.0000 -14.8214 
                          0.0000   0.0000 -80.7260 -21.5543  14.8209  -0.0000 
                          0.0000 -63.4384   0.0000  -9.4837   0.0000 -14.8208 
                         -0.0000   0.0000 -46.1509 -14.8206   0.0002   0.0000 
                         -0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                          0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                          0.0000  16.5238   0.0000   1.3353   0.0000   0.0005 ];
 
JointWrench_PC_FB{15} = [ 0.0000 108.1749   0.0000 -22.7631   0.0000  36.3751 
                          0.0000 -97.5180   0.0000 -11.5646   0.0000 -36.3756 
                         -0.0000   0.0000 -80.7260 -36.3751   0.0006   0.0000 
                         -0.0000 -63.4384   0.0000 -24.3045   0.0000  -0.0004 
                          0.0000   0.0000 -46.1509 -14.8206   0.0002  -0.0000 
                         -0.0000 -31.2221   0.0000  -6.2177   0.0000  -0.0007 
                          0.0000   0.0000 -23.8223  -3.3222   0.0001  -0.0000 
                          0.0000  16.5238   0.0000   1.3353   0.0000   0.0005];

                      
%% Data process and computation: Gravity Model Evaluation

for iRobotConfig = 1:15
    
    % adapt name convention to previous developped code and latex later
    JointWrench_RobotBase{iRobotConfig}(1,:) = RobotConfig(iRobotConfig).BaseJointCartesianWrench;
    JointWrench_Sensor(1,iRobotConfig) = nan;
    for jActuator = 1:7
        Pose_Feedback(iRobotConfig, jActuator)  = RobotConfig(iRobotConfig).Actuator(jActuator).Position;
        Pose(iRobotConfig, jActuator)  = RobotConfig(iRobotConfig).Actuator(jActuator).Command;
        JointWrench_RobotBase{iRobotConfig}(jActuator+1,:) = RobotConfig(iRobotConfig).Actuator(jActuator).CartesianWrench;
        JointWrench_Sensor(jActuator+1,iRobotConfig) = RobotConfig(iRobotConfig).Actuator(jActuator).RawTorque;
    end

    % Error when JointWrench_PC is computed with nominal joint command
    JointWrench_Error{iRobotConfig} = JointWrench_PC{iRobotConfig} - JointWrench_RobotBase{iRobotConfig};
    JointWrench_Error_ForceX(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,1);
    JointWrench_Error_ForceY(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,2);
    JointWrench_Error_ForceZ(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,3);
    JointWrench_Error_TorqueX(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,4);
    JointWrench_Error_TorqueY(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,5);
    JointWrench_Error_TorqueZ(:,iRobotConfig) = JointWrench_Error{iRobotConfig}(:,6);
    
    % Error when JointWrench_PC is computed with joint feedback from test
    JointWrench_Error_FB{iRobotConfig} = JointWrench_PC_FB{iRobotConfig} - JointWrench_RobotBase{iRobotConfig};
    JointWrench_Error_FB_ForceX(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,1);
    JointWrench_Error_FB_ForceY(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,2);
    JointWrench_Error_FB_ForceZ(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,3);
    JointWrench_Error_FB_TorqueX(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,4);
    JointWrench_Error_FB_TorqueY(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,5);
    JointWrench_Error_FB_TorqueZ(:,iRobotConfig) = JointWrench_Error_FB{iRobotConfig}(:,6);
    
%     JointWrench_Diff_FB{iRobotConfig} = JointWrench_PC{iRobotConfig} - JointWrench_PC_FB{iRobotConfig};
%     JointWrench_Diff_FB_ForceX(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,1);
%     JointWrench_Diff_FB_ForceY(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,2);
%     JointWrench_Diff_FB_ForceZ(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,3);
%     JointWrench_Diff_FB_TorqueX(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,4);
%     JointWrench_Diff_FB_TorqueY(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,5);
%     JointWrench_Diff_FB_TorqueZ(:,iRobotConfig) = JointWrench_Diff_FB{iRobotConfig}(:,6);
    
    
    JointWrench_Sensor_Error(:,iRobotConfig) = JointWrench_Sensor(:,iRobotConfig) - JointWrench_RobotBase{iRobotConfig}(:,6);
end


%% Data process and computation: SensorReliability

% sensor noise
for iRobotConfig = 1:15
    for jActuator = 1:7
        sensorVariation(jActuator, iRobotConfig) = max(RobotConfig(iRobotConfig).Actuator(jActuator).RawTorqueVector) - min(RobotConfig(iRobotConfig).Actuator(jActuator).RawTorqueVector);
        zeroSensorTorque(jActuator, iRobotConfig) = RobotConfig(iRobotConfig).Actuator(jActuator).RawTorque0; 
    end
end
disp('Log file does not seems good. Not for the moment at ZeroTorque position. Reason unknown:');
zeroSensorTorque,

% Seal Impact to Joint Torque Sensor
disp('Log file does not seems good for actuator 2. Reason unknown:');
ActuatorSealTorque,


%% OUTPUT AND DISPLAY 

disp('In robot test, joint command of actuator 6 (307.70 degree) at predefined Pose3 cannot be achieved, due to physical limit. In this case, command 307 degree is given in stead.');
disp('The test and computation regarding to Pose3 are subjected to this minor modification.');

kcaxis = [0, 0.005]; % range for imagesc plot


% JointWrench_PC - JointWrench_RobotBase; 
title_str = 'Force X Error';
h_FX = drawcell(abs(JointWrench_Error_ForceX), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Force Y Error';
h_FY = drawcell(abs(JointWrench_Error_ForceY), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Force Z Error';
h_FZ = drawcell(abs(JointWrench_Error_ForceZ), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque X Error';
h_TX = drawcell(abs(JointWrench_Error_TorqueX), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque Y Error';
h_TY = drawcell(abs(JointWrench_Error_TorqueY), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque Z Error';
h_TZ = drawcell(abs(JointWrench_Error_TorqueZ), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);


% JointWrench_PC_FB - JointWrench_RobotBase; 
title_str = 'Force X Error FB';
h_FX = drawcell(abs(JointWrench_Error_FB_ForceX), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Force Y Error FB';
h_FY = drawcell(abs(JointWrench_Error_FB_ForceY), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Force Z Error FB';
h_FZ = drawcell(abs(JointWrench_Error_FB_ForceZ), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque X Error FB';
h_TX = drawcell(abs(JointWrench_Error_FB_TorqueX), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque Y Error FB';
h_TY = drawcell(abs(JointWrench_Error_FB_TorqueY), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

title_str = 'Torque Z Error FB';
h_TZ = drawcell(abs(JointWrench_Error_FB_TorqueZ), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);


% % JointWrench_PC - JointWrench_PC_FB; 
% title_str = 'Differences of Force X';
% h_FX = drawcell(abs(JointWrench_Diff_FB_ForceX), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);
% 
% title_str = 'Differences of Force Y';
% h_FY = drawcell(abs(JointWrench_Diff_FB_ForceY), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);
% 
% title_str = 'Differences of Force Z';
% h_FZ = drawcell(abs(JointWrench_Diff_FB_ForceZ), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);
% 
% title_str = 'Differences of Torque X';
% h_TX = drawcell(abs(JointWrench_Diff_FB_TorqueX), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);
% 
% title_str = 'Differences of Torque Y';
% h_TY = drawcell(abs(JointWrench_Diff_FB_TorqueY), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);
% 
% title_str = 'Differences of Torque Z';
% h_TZ = drawcell(abs(JointWrench_Diff_FB_TorqueZ), kcaxis);
% disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);


% JointWrench_Sensor - JointWrench_RobotBase_Tz; 
kcaxis = [0, 5];
title_str = 'Sensor Error to Base Joint Wrench';
h_Sensor = drawcell(abs(JointWrench_Sensor_Error), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);



% Sensor Noise: plot the test contains maximum variation.
kcaxis = [0, 2];
title_str = 'Sensor Noise Variation of all Configuration Tests';
h_SensorVariation = drawcell(abs(sensorVariation), kcaxis);
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);

[max_jActuator,max_iRobotConfig] = find( sensorVariation == max(max(sensorVariation)) );
h_SensorNoise = figure;
title_str = ['Sensor Noise in Configuration ', num2str(max_iRobotConfig)];
% title(title_str);
hold on;
for jActuator = 1:7
    plot(RobotConfig(max_iRobotConfig).Actuator(jActuator).RawTorqueVector, 'LineWidth',2); 
end
ylabel('Torque Sensor in Nm');
xlabel('Test Sample Time: ms');
legend('Actuator1', 'Actuator2', 'Actuator3', 'Actuator4', 'Actuator5', 'Actuator6', 'Actuator7');
hold off;
set(gca,'FontSize', 20);
set(gcf, 'Position', get(0,'Screensize')); % Maximize figure.
disp(title_str); saveas(gcf,['..\TMxx-report\images\',regexprep(title_str,'\W',''), '.png']); close(gcf);


%% Generate Latex file

texFolder = '../TMxx-report/';
texFileMaster = [texFolder, 'MASTER.tex'];
texFileTestSetup = [texFolder, 'testSetup_template.tex'];
texFileTestSetupWithValue = [strtok(texFileTestSetup, '_'),'.tex']; %New File name
texFileAppendix = [texFolder,'appendix_template.tex'];
texFileAppendixWithValue = [strtok(texFileAppendix, '_'),'.tex']; %New File name

% update part of values in one template each time
latexfileTestSetupTemplate = fileread(texFileTestSetup);
latexfileTestSetupNew = latexfileTestSetupTemplate;
% appending template increasingly
latexfileAppendixTemplate = fileread(texFileAppendix);
latexfileAppendixNew = '';

% use the table template for 15 tests, each test appears as a subsection in
% appendix.c
for poseIndex = 1:15

    latexfileAppendixNew = strcat(latexfileAppendixNew, latexfileAppendixTemplate);
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_POSE_NUM', num2str(poseIndex) );
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_POSE', ['[ ', num2str(Pose(poseIndex,:)), ']'] );
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_LABEL_PC', ['wrech_PC_Pose', num2str(poseIndex)] );
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_LABEL_ROBOT', ['wrech_Robot_Pose', num2str(poseIndex)] );
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_LABEL_ERROR', ['wrech_Error_Pose', num2str(poseIndex)] );
    latexfileAppendixNew = strrep(latexfileAppendixNew,   'VAR_LABEL_SENSOR', ['wrech_Sensor_Pose', num2str(poseIndex)] );

    for wrenchIndex = 1:6
        for jointIndex = 0:7 
            % copy Joint wrench PC data to table
            latexfileAppendixNew = strrep(latexfileAppendixNew,   ['VAR_PC_', num2str(wrenchIndex), num2str(jointIndex)], num2str(JointWrench_PC{poseIndex}(jointIndex+1, wrenchIndex), '%0.4f') );
            % copy Joint wrench Robot data to table
            latexfileAppendixNew = strrep(latexfileAppendixNew,   ['VAR_ROBOT_', num2str(wrenchIndex), num2str(jointIndex)], num2str(JointWrench_RobotBase{poseIndex}(jointIndex+1, wrenchIndex), '%0.4f') );
            % copy Joint wrench Error data to table
            latexfileAppendixNew = strrep(latexfileAppendixNew,   ['VAR_ERROR_', num2str(wrenchIndex), num2str(jointIndex)], num2str(JointWrench_Error{poseIndex}(jointIndex+1, wrenchIndex), '%0.4f') );
        end
    end

    % copy Joint wrench Sensor data to table
    for jointIndex = 1:7
         % copy Predefined Robot configurations to table
        latexfileTestSetupNew = strrep(latexfileTestSetupNew,   ['VAR_P', num2str(poseIndex), '_', num2str(jointIndex)], num2str(RobotConfig(poseIndex).Actuator(jointIndex).Command) );
        
        latexfileAppendixNew = strrep(latexfileAppendixNew,   ['VAR_SENSOR_', num2str(jointIndex)], num2str(JointWrench_Sensor(jointIndex+1, poseIndex)) );
    end

end

fileID = fopen(texFileTestSetupWithValue,'w');
fprintf(fileID,'%s',latexfileTestSetupNew);
fclose(fileID);
fileID = fopen(texFileAppendixWithValue,'w');
fprintf(fileID,'%s',latexfileAppendixNew);
fclose(fileID);

folderleft = cd(texFolder);
system(['PdfLaTex ', texFileMaster]);
% system(['PdfLaTex ', texFileMaster]);
cd(folderleft);
copyfile([texFolder, 'MASTER.pdf'],[texFolder,'GravityModelReport.pdf']);

fprintf('\nGenerating Latex report has finished without any issues.\n')

